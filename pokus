import discord
from discord.ext import commands
import asyncio  # Import the asyncio module

# Your bot's token
TOKEN = 'MTIxNDI4NzgyMTQ2OTEzMDgxNg.GGl7Hz.TREhwdykXrtIzLhloMokvozDxXNH46R9z5P6bo'

# Your voice channel ID where you want the bot to start playing music
VOICE_CHANNEL_ID = 934605327104622602

# Your playlist of songs
PLAYLIST = [
    'Monday1.mp3'
    'No Respect.mp3'
    'Bentley.mp3'
    'Louis Vuitton.mp3'
    'Shisha.mp3'
    'Lollipop.mp3'
    'Demoni.mp3'
    'Richman Dreamteam.mp3'
         
]

# Define intents
intents = discord.Intents.default()
intents.voice_states = True

# Initialize bot with intents
bot = commands.Bot(command_prefix='!', intents=intents)

@bot.event
async def on_ready():
    print(f'Logged in as {bot.user}')

@bot.event
async def on_voice_state_update(member, before, after):
    if after.channel and after.channel.id == VOICE_CHANNEL_ID and before.channel != after.channel:
        # The member joined the specific voice channel
        voice_channel = after.channel
        voice_client = await voice_channel.connect()

        # Play the playlist
        for song in PLAYLIST:
            source = discord.FFmpegPCMAudio(song)
            voice_client.play(source)
            while voice_client.is_playing():
                await asyncio.sleep(1)  # Wait for the song to finish playing

        # Disconnect after playing the playlist
        await voice_client.disconnect()
    elif before.channel and before.channel.id == VOICE_CHANNEL_ID and after.channel != before.channel:
        # The member left the specific voice channel
        voice_channel = before.channel
        # Check if the bot is the only member left in the voice channel
        if len(voice_channel.members) == 1 and voice_channel.members[0] == bot.user:
            voice_client = await voice_channel.connect()
            await voice_client.disconnect()

# Run the bot
bot.run(TOKEN)
